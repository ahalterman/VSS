#import sys
#from os import path
#sys.path.append( path.dirname( path.dirname( path.abspath(__file__) ) ) )
import datetime
from extract_XML import extract_xml

def test_one():
    doc1 = """'<?xml version="1.0" encoding="UTF-8"?><!--Transformation version 1.1--><articleDoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.lexisnexis.com/xmlschemas/content/public/articledoc/1/" schemaVersion="1.0" xml:lang="en"><articleDocHead><itemInfo/></articleDocHead><nitf:body xmlns:nitf="http://iptc.org/std/NITF/2006-10-18/"><nitf:body.head><nitf:hedline><nitf:hl1>Official: Pakistan Prioritizes IP Gas Pipeline</nitf:hl1></nitf:hedline></nitf:body.head><nitf:body.content><bodyText><p nitf:lede="true">TEHRAN (FNA)- Just some made up text here.</p></bodyText></nitf:body.content></nitf:body><metadata><dc:metadata xmlns:dc="http://purl.org/dc/elements/1.1/"><dc:identifier identifierScheme="DOC-ID">37858717</dc:identifier><dc:source sourceScheme="royaltyReportingKey">FARSNA2014</dc:source><dc:identifier identifierScheme="PGUID">urn:contentItem:5CBP-FHY1-JDJN-63M6-00000-00</dc:identifier><dc:source sourceScheme="productContentSetIdentifier">356949</dc:source><dc:date dateType="last-updated">2014-06-03</dc:date></dc:metadata><wordCount number="33"/><publicationInfo><copyright>Copyright 2014 Fars News Agency. Provided by Syndigate.info, an Albawaba.com company All Rights Reserved</copyright><publicationName>FARS News Agency</publicationName><publicationLogo><logo><inlineObject><locator><locatorKey><keyName name="object-key"/><keyValue value="64265"/></locatorKey><locatorParameters><parameter name="object-type" value="201"/><parameter name="object-smi" value="LOGOS"/><parameter name="componentseq" value="1"/></locatorParameters></locator></inlineObject></logo></publicationLogo><publicationDate day="29" month="05" year="2014"><dateText>May 29, 2014 Thursday</dateText></publicationDate><classification classificationScheme="publicationtype"><classificationItem><className>Newswire</className></classificationItem></classification><classification classificationScheme="publicationtype"><classificationItem><className>Newswires &amp; Press Releases</className></classificationItem></classification></publicationInfo><classification classificationScheme="language"><classificationItem classificationScheme="lang.english"><className>ENGLISH</className></classificationItem></classification><classificationGroup classificationScheme="indexing-terms"><classification classificationScheme="subject"><classificationItem score="90"><classCode>N486000CC</classCode><className>PIPELINE TRANSPORTATION</className></classificationItem><classificationItem score="90"><classCode>STX001198</classCode><className>NATURAL GAS PRODUCTS</className></classificationItem><classificationItem score="90"><classCode>N486210MM</classCode><className>NATURAL GAS PIPELINES</className></classificationItem><classificationItem score="85"><classCode>ST000DBCO</classCode><className>NATURAL GAS</className></classificationItem></classification><classification classificationScheme="city"><classificationItem score="74"><classCode>GX159</classCode><className>TEHRAN, IRAN, ISLAMIC REPUBLIC OF</className></classificationItem><classificationItem score="71"><classCode>GX248</classCode><className>ISLAMABAD, PAKISTAN</className></classificationItem></classification><classification classificationScheme="country"><classificationItem score="93"><classCode>GC368</classCode><className>IRAN, ISLAMIC REPUBLIC OF</className></classificationItem><classificationItem score="93"><classCode>GC309</classCode><className>PAKISTAN</className></classificationItem><classificationItem score="74"><className>IRAN</className></classificationItem></classification></classificationGroup><classificationGroup classificationScheme="indexing-terms"><classification classificationScheme="legal"><classificationItem><className>Energy &amp; Utilities Law</className><classCode>Z3VpZD11cm46dG9waWM6OUUzODAyRDk1QzVFNEZGMEJDM0RGMDYxOTlEMEEzRDA7cGFyZW50Z3VpZD0</classCode><classificationItem score="50"><className>General Overview</className><classCode>Z3VpZD11cm46dG9waWM6NEJFOTZCNDdFOEJCNEU2Mjg2OUI3QzU2NTExRTkxRDM7cGFyZW50Z3VpZD11cm46dG9waWM6OTYxNzdCMkVBQkIyNEM2RTk2MDkzQjNEMTg4MzVFRTE</classCode></classificationItem><classificationItem score="50"><className>Natural Gas Transportation</className><classCode>Z3VpZD11cm46dG9waWM6QTI4NjU3NDIxOTkzNDU4QUE1MzkzMURFMjI5OTQxMUE7cGFyZW50Z3VpZD11cm46dG9waWM6QjMwQzNCRThDRjkwNDY0QjlFNDJFQzY5QzVCMEE0MTY</classCode></classificationItem></classificationItem></classification></classificationGroup></metadata></articleDoc>\r\n'"""

    parsed1 = {'article_body': u'TEHRAN (FNA)- Just some made up text here.',
               'article_title': u'Official: Pakistan Prioritizes IP Gas Pipeline',
               'cities': [u'TEHRAN, IRAN, ISLAMIC REPUBLIC OF'],
               'countries': [u'IRAN, ISLAMIC REPUBLIC OF'],
               'doc_id': u'37858717',
               'news_source': u'FARS News Agency',
               'position_section': '',
               'publication_date': datetime.datetime(2014, 5, 29, 0, 0),
               'publication_date_raw': u'May 29, 2014 Thursday',
               'states': [],
               'word_count': '33'}

    assert extract_xml(doc1) == parsed1

def test_two():
    doc = """'xml': '<?xml version="1.0" encoding="UTF-8"?><!--Transformation version 1.1--><articleDoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.lexisnexis.com/xmlschemas/content/public/articledoc/1/" schemaVersion="1.0" xml:lang="en"><articleDocHead><itemInfo><sourceSectionInfo><positionSection>OBITUARIES</positionSection><positionSequence>Pg. A</positionSequence></sourceSectionInfo></itemInfo></articleDocHead><nitf:body xmlns:nitf="http://iptc.org/std/NITF/2006-10-18/"><nitf:body.head><nitf:hedline><nitf:hl1>F. SHELMON DAIL, SR.</nitf:hl1></nitf:hedline></nitf:body.head><nitf:body.content><bodyText><p nitf:lede="true">Some made up text.</p><p/></bodyText></nitf:body.content></nitf:body><metadata><dc:metadata xmlns:dc="http://purl.org/dc/elements/1.1/"><dc:identifier identifierScheme="DOC-ID">140216137791035</dc:identifier><dc:source sourceScheme="royaltyReportingKey">BALSUN2014</dc:source><dc:identifier identifierScheme="PGUID">urn:contentItem:5BHW-XSC1-DY37-C52H-00000-00</dc:identifier><dc:source sourceScheme="productContentSetIdentifier">306883</dc:source><dc:date dateType="last-updated">2014-08-16</dc:date></dc:metadata><wordCount number="133"/><publicationInfo><copyright>Copyright 2014 The Baltimore Sun Company All Rights Reserved</copyright><publicationName>The Baltimore Sun</publicationName><edition>FINAL EDITION</edition><publicationDate day="16" month="02" year="2014"><dateText>February 16, 2014 Sunday</dateText></publicationDate><classification classificationScheme="publicationtype"><classificationItem><className>Newspaper</className></classificationItem></classification><classification classificationScheme="publicationtype"><classificationItem><className>Newspapers</className></classificationItem></classification></publicationInfo><classification classificationScheme="language"><classificationItem classificationScheme="lang.english"><className>ENGLISH</className></classificationItem></classification><classificationGroup classificationScheme="indexing-terms"><classification classificationScheme="subject"><classificationItem score="98"><classCode>STX000454</classCode><className>DEATHS &amp; OBITUARIES</className></classificationItem></classification><classification classificationScheme="country"><classificationItem score="69"><classCode>GC343</classCode><className>UNITED STATES</className></classificationItem></classification><classification classificationScheme="state"><classificationItem score="69"><classCode>GS136</classCode><className>MARYLAND, USA</className></classificationItem></classification></classificationGroup><classificationGroup classificationScheme="indexing-terms"><classification classificationScheme="legal"><classificationItem><className>Estate, Gift &amp; Trust Law</className><classCode>Z3VpZD11cm46dG9waWM6OENGNTY0MEQ2RTU2NDA2NTk4QjcyNzI2NTBERUU3NUI7cGFyZW50Z3VpZD0</classCode><classificationItem score="50"><className>Priority of Claims</className><classCode>Z3VpZD11cm46dG9waWM6NDg2MUNCMDA3MENGNDUwQ0E0NjMyNTc4RjZENjI0OEI7cGFyZW50Z3VpZD11cm46dG9waWM6OTJDNDU3QUZFMzE2NDgzREEwMjI0OTcyQjFDMUZGQ0I</classCode></classificationItem></classificationItem></classification></classificationGroup></metadata></articleDoc>\r\n'"""

    parsed = {'article_body': u'Some made up text.',
              'article_title': u'F. SHELMON DAIL, SR.',
              'cities': [],
              'countries': [u'UNITED STATES'],
              'doc_id': u'140216137791035',
              'news_source': u'The Baltimore Sun',
              'position_section': u'OBITUARIES',
              'publication_date': datetime.datetime(2014, 2, 16, 0, 0),
              'publication_date_raw': u'February 16, 2014 Sunday',
              'states': [u'MARYLAND, USA'],
              'word_count': '133'}

    assert extract_xml(doc) == parsed

if __name__ == "__main__":
   test_one()
